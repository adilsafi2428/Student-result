<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instant Report Card Generator</title>
    <!-- Tailwind CSS CDN for styling and responsiveness -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a clean look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 900px;
        }
        .report-card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .no-print {
            display: block;
        }
        @media print {
            body {
                background-color: #fff;
            }
            .no-print {
                display: none;
            }
            .report-card {
                box-shadow: none;
                border: 1px solid #000;
            }
            /* Ensure the report card content fills the page in print */
            .container {
                max-width: 100%;
                margin: 0;
            }
            .report-card-section {
                padding: 0;
            }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main Application Container -->
    <div id="app" class="w-full">
        <!-- Input Form Section (No-Print) -->
        <div id="input-form" class="no-print container mx-auto p-6 bg-white rounded-xl shadow-lg border border-gray-200">
            <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">Instant Report Card Generator</h1>
            <p class="text-center text-gray-600 mb-8">Enter student information and subject marks to generate a report card.</p>

            <form id="result-form">
                <div class="space-y-6">
                    
                    <!-- Student Information -->
                    <hr class="my-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Student Information</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="student-name" class="block text-sm font-medium text-gray-700">Student Name</label>
                            <input type="text" id="student-name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" placeholder="e.g., Ali Ahmed" required>
                        </div>
                        <div>
                            <label for="roll-number" class="block text-sm font-medium text-gray-700">Roll Number</label>
                            <input type="text" id="roll-number" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" placeholder="e.g., 123456" required>
                        </div>
                        <div>
                            <label for="student-class" class="block text-sm font-medium text-gray-700">Class</label>
                            <input type="text" id="student-class" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" placeholder="e.g., 10th Grade" required>
                        </div>
                    </div>

                    <hr class="my-6">
                    
                    <!-- Subject Marks Section -->
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Subject Marks</h2>
                    <div id="subjects-container" class="space-y-4">
                        <!-- Dynamic subject rows will be pre-filled and added here -->
                    </div>
                    
                    <div class="flex justify-end mt-4">
                        <button type="button" id="add-subject-btn" class="px-4 py-2 rounded-full text-white font-bold bg-gray-500 hover:bg-gray-600 transition-colors duration-200 shadow-md">
                            + Add Subject
                        </button>
                    </div>
                </div>

                <div class="mt-8 flex justify-center">
                    <button type="submit" class="w-full md:w-auto px-6 py-3 rounded-full text-white font-bold bg-indigo-600 hover:bg-indigo-700 transition-colors duration-200 shadow-md">
                        Generate Report Card
                    </button>
                </div>
            </form>
        </div>

        <!-- Result Card Display Section (Initially Hidden) -->
        <div id="result-card-container" class="hidden no-print container mx-auto p-8 report-card">
            <div id="report-card-content">
                <!-- Content will be generated by JavaScript -->
            </div>
            
            <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center items-center no-print">
                <button onclick="printReportCard()" class="w-full sm:w-auto px-6 py-3 rounded-full text-white font-bold bg-green-600 hover:bg-green-700 transition-colors duration-200 shadow-md">
                    Print / PDF
                </button>
                <button onclick="resetForm()" class="w-full sm:w-auto px-6 py-3 rounded-full text-gray-700 font-bold bg-gray-200 hover:bg-gray-300 transition-colors duration-200 shadow-md">
                    Go Back
                </button>
            </div>
        </div>
    </div>

    <script>
        // Get DOM elements
        const form = document.getElementById('result-form');
        const subjectsContainer = document.getElementById('subjects-container');
        const addSubjectBtn = document.getElementById('add-subject-btn');
        const inputForm = document.getElementById('input-form');
        const resultCardContainer = document.getElementById('result-card-container');
        const reportCardContent = document.getElementById('report-card-content');
        let subjectCounter = 0; // To ensure unique IDs

        // Dynamically create subject input fields
        function addSubjectInput(name = '', obtained = '', total = 100) {
            const subjectDiv = document.createElement('div');
            subjectDiv.className = 'grid grid-cols-1 sm:grid-cols-4 gap-4 items-center subject-row';
            const uniqueId = subjectCounter++;
            subjectDiv.innerHTML = `
                <div class="col-span-full sm:col-span-1">
                    <label for="subject-name-${uniqueId}" class="block text-sm font-medium text-gray-700">Subject Name</label>
                    <input type="text" id="subject-name-${uniqueId}" name="subject-name" class="w-full rounded-md border-gray-300 shadow-sm p-2 border mt-1" placeholder="e.g., Urdu" value="${name}" required>
                </div>
                <div class="flex items-center col-span-1">
                    <label for="obtained-marks-${uniqueId}" class="block text-sm font-medium text-gray-700">Obtained</label>
                    <input type="number" id="obtained-marks-${uniqueId}" name="obtained-marks" class="w-full rounded-md border-gray-300 shadow-sm p-2 border mr-2 mt-1" min="0" value="${obtained}" required>
                </div>
                <div class="flex items-center col-span-1">
                    <label for="total-marks-${uniqueId}" class="block text-sm font-medium text-gray-700">Total</label>
                    <input type="number" id="total-marks-${uniqueId}" name="total-marks" class="w-full rounded-md border-gray-300 shadow-sm p-2 border mr-2 mt-1" min="1" value="${total}" required>
                </div>
                <div class="col-span-1 flex justify-end">
                    <button type="button" class="remove-subject-btn px-3 py-2 text-white bg-red-500 rounded-full hover:bg-red-600 transition-colors duration-200 shadow-md">Remove</button>
                </div>
            `;
            subjectsContainer.appendChild(subjectDiv);
        }

        // Add event listener for the "Add Subject" button
        addSubjectBtn.addEventListener('click', () => {
            addSubjectInput();
        });

        // Add event listener to remove subject buttons
        subjectsContainer.addEventListener('click', (event) => {
            if (event.target.classList.contains('remove-subject-btn')) {
                event.target.closest('.subject-row').remove();
            }
        });
        
        // Handle form submission
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            generateResultCard();
        });

        function getRemarks(percentage) {
            if (percentage >= 85) {
                return "Excellent Performance";
            } else if (percentage >= 70) {
                return "Very Good";
            } else if (percentage >= 60) {
                return "Good";
            } else if (percentage >= 50) {
                return "Needs Improvement";
            } else {
                return "Work Harder";
            }
        }

        function getGrade(percentage) {
            if (percentage >= 90) return 'A+';
            if (percentage >= 80) return 'A';
            if (percentage >= 70) return 'B';
            if (percentage >= 60) return 'C';
            if (percentage >= 50) return 'D';
            return 'F';
        }

        function generateResultCard() {
            // Hardcoded school info
            const schoolName = "Landkotal";
            const schoolTagline = "Student Report Card";
            const finalLogoUrl = 'https://placehold.co/100x100/A5B4FC/3730A3?text=Logo';

            // Get student info
            const studentName = document.getElementById('student-name').value;
            const rollNumber = document.getElementById('roll-number').value;
            const studentClass = document.getElementById('student-class').value;
            const currentDate = new Date().toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            let totalObtainedMarks = 0;
            let totalMaxMarks = 0;
            const marksData = [];

            // Get marks from all subject rows
            const subjectRows = document.querySelectorAll('.subject-row');
            subjectRows.forEach((row) => {
                const subjectName = row.querySelector('[name="subject-name"]').value;
                const obtainedMarks = parseInt(row.querySelector('[name="obtained-marks"]').value);
                const totalMarks = parseInt(row.querySelector('[name="total-marks"]').value);

                totalObtainedMarks += obtainedMarks;
                totalMaxMarks += totalMarks;

                const subjectPercentage = (obtainedMarks / totalMarks) * 100;
                const grade = getGrade(subjectPercentage);

                marksData.push({
                    name: subjectName,
                    obtained: obtainedMarks,
                    total: totalMarks,
                    grade: grade
                });
            });

            // Calculate overall percentage and get remarks
            const overallPercentage = (totalObtainedMarks / totalMaxMarks) * 100;
            const remarks = getRemarks(overallPercentage);

            // Construct the HTML for the result card
            const resultCardHTML = `
                <div class="report-card-section p-8">
                    <header class="flex flex-col items-center text-center border-b-2 border-gray-300 pb-4 mb-6">
                        <img src="${finalLogoUrl}" onerror="this.onerror=null;this.src='https://placehold.co/100x100/A5B4FC/3730A3?text=Logo';" alt="School Logo" class="w-16 h-16 rounded-full mb-2">
                        <h2 class="text-3xl font-bold text-gray-900">${schoolName}</h2>
                        <h3 class="text-xl font-semibold text-gray-700 mt-2">${schoolTagline}</h3>
                    </header>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm md:text-base">
                        <p class="text-gray-700"><span class="font-semibold text-gray-900">Name:</span> ${studentName}</p>
                        <p class="text-gray-700"><span class="font-semibold text-gray-900">Class:</span> ${studentClass}</p>
                        <p class="text-gray-700"><span class="font-semibold text-gray-900">Roll Number:</span> ${rollNumber}</p>
                        <p class="text-gray-700"><span class="font-semibold text-gray-900">Date:</span> ${currentDate}</p>
                    </div>

                    <div class="mt-8">
                        <table class="w-full table-auto border-collapse">
                            <thead>
                                <tr class="bg-indigo-100 text-indigo-800">
                                    <th class="border border-indigo-200 p-3 text-left">Subject</th>
                                    <th class="border border-indigo-200 p-3 text-center">Total Marks</th>
                                    <th class="border border-indigo-200 p-3 text-center">Obtained Marks</th>
                                    <th class="border border-indigo-200 p-3 text-center">Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${marksData.map(mark => `
                                    <tr class="text-gray-800 even:bg-gray-50">
                                        <td class="border border-gray-200 p-3 text-left">${mark.name}</td>
                                        <td class="border border-gray-200 p-3 text-center">${mark.total}</td>
                                        <td class="border border-gray-200 p-3 text-center">${mark.obtained}</td>
                                        <td class="border border-gray-200 p-3 text-center">${mark.grade}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                            <tfoot>
                                <tr class="bg-gray-200 text-gray-900 font-bold">
                                    <td class="border border-gray-300 p-3 text-left">Total</td>
                                    <td class="border border-gray-300 p-3 text-center">${totalMaxMarks}</td>
                                    <td class="border border-gray-300 p-3 text-center">${totalObtainedMarks}</td>
                                    <td class="border border-gray-300 p-3 text-center"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div class="mt-8 text-center bg-gray-100 p-6 rounded-lg">
                        <h4 class="text-xl font-bold text-gray-800 mb-2">Total Percentage: ${overallPercentage.toFixed(2)}%</h4>
                        <h5 class="text-lg font-semibold text-indigo-700">Remarks: ${remarks}</h5>
                    </div>
                </div>
            `;
            
            // Display the result card and hide the form
            reportCardContent.innerHTML = resultCardHTML;
            inputForm.classList.add('hidden');
            resultCardContainer.classList.remove('hidden');
        }

        // Function to handle Print/PDF button
        function printReportCard() {
            window.print();
        }

        // Function to reset the application
        function resetForm() {
            form.reset();
            // Clear all dynamically added subjects and prefill again
            subjectsContainer.innerHTML = '';
            prefillSubjects();
            inputForm.classList.remove('hidden');
            resultCardContainer.classList.add('hidden');
        }

        // Prefill function to add initial subjects when the page loads
        function prefillSubjects() {
            const initialSubjects = [
                { name: "Urdu", total: 100 },
                { name: "English", total: 100 },
                { name: "Mathematics", total: 100 },
                { name: "Science", total: 100 },
                { name: "Computer Science", total: 75 },
            ];
            initialSubjects.forEach(subject => addSubjectInput(subject.name, '', subject.total));
        }

        // Call prefill function on initial page load
        prefillSubjects();

    </script>
</body>
</html>